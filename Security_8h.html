<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XenevaOS: XenevaOS/Boot/include/Protocol/Security.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">XenevaOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6f7cbf0a11b44b0a43b1ec16e930d793.html">XenevaOS</a></li><li class="navelem"><a class="el" href="dir_e155a64606be01e9718a8b1197c63fff.html">Boot</a></li><li class="navelem"><a class="el" href="dir_08690fdcb6b3138c931f33749be09044.html">include</a></li><li class="navelem"><a class="el" href="dir_b641ebb3d870e3bbb06aca4db697d2ea.html">Protocol</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Security.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="Security_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__EFI__SECURITY__ARCH__PROTOCOL.html">_EFI_SECURITY_ARCH_PROTOCOL</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a538701c94ceb005973ead9249b9bdb09" id="r_a538701c94ceb005973ead9249b9bdb09"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Security_8h.html#a538701c94ceb005973ead9249b9bdb09">EFI_SECURITY_ARCH_PROTOCOL_GUID</a>&#160;&#160;&#160;  { 0xA46423E3, 0x4617, 0x49f1, {0xB9, 0xFF, 0xD1, 0xBF, 0xA9, 0x11, 0x58, 0x39 } }</td></tr>
<tr class="separator:a538701c94ceb005973ead9249b9bdb09"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a9de736689ef480e94bb4daceaa9ca80b" id="r_a9de736689ef480e94bb4daceaa9ca80b"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__EFI__SECURITY__ARCH__PROTOCOL.html">_EFI_SECURITY_ARCH_PROTOCOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Security_8h.html#a9de736689ef480e94bb4daceaa9ca80b">EFI_SECURITY_ARCH_PROTOCOL</a></td></tr>
<tr class="separator:a9de736689ef480e94bb4daceaa9ca80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5256c218031c1f0f22820f4333333904" id="r_a5256c218031c1f0f22820f4333333904"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Security_8h.html#a5256c218031c1f0f22820f4333333904">EFI_SECURITY_FILE_AUTHENTICATION_STATE</a>) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="Security_8h.html#a9de736689ef480e94bb4daceaa9ca80b">EFI_SECURITY_ARCH_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> AuthenticationStatus, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="structEFI__DEVICE__PATH__PROTOCOL.html">EFI_DEVICE_PATH_PROTOCOL</a> *File)</td></tr>
<tr class="separator:a5256c218031c1f0f22820f4333333904"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac0d0bc7a4c4da27cd14c97b709f7dc45" id="r_ac0d0bc7a4c4da27cd14c97b709f7dc45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Security_8h.html#ac0d0bc7a4c4da27cd14c97b709f7dc45">gEfiSecurityArchProtocolGuid</a></td></tr>
<tr class="separator:ac0d0bc7a4c4da27cd14c97b709f7dc45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Security Architectural Protocol as defined in PI Specification VOLUME 2 DXE</p>
<p>Used to provide Security services. Specifically, dependening upon the authentication state of a discovered driver in a Firmware Volume, the portable DXE Core Dispatcher will call into the Security Architectural Protocol (SAP) with the authentication state of the driver.</p>
<p>This call-out allows for OEM-specific policy decisions to be made, such as event logging for attested boots, locking flash in response to discovering an unsigned driver or failed signature check, or other exception response.</p>
<p>The SAP can also change system behavior by having the DXE core put a driver in the Schedule-On-Request (SOR) state. This will allow for later disposition of the driver by platform agent, such as Platform BDS.</p>
<p>Copyright (c) 2006 - 2018, Intel Corporation. All rights reserved.<br  />
 This program and the accompanying materials are licensed and made available under the terms and conditions of the BSD License which accompanies this distribution. The full text of the license may be found at <a href="http://opensource.org/licenses/bsd-license.php">http://opensource.org/licenses/bsd-license.php</a></p>
<p>THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a538701c94ceb005973ead9249b9bdb09" name="a538701c94ceb005973ead9249b9bdb09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a538701c94ceb005973ead9249b9bdb09">&#9670;&#160;</a></span>EFI_SECURITY_ARCH_PROTOCOL_GUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EFI_SECURITY_ARCH_PROTOCOL_GUID&#160;&#160;&#160;  { 0xA46423E3, 0x4617, 0x49f1, {0xB9, 0xFF, 0xD1, 0xBF, 0xA9, 0x11, 0x58, 0x39 } }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Global ID for the Security Code Architectural Protocol </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a9de736689ef480e94bb4daceaa9ca80b" name="a9de736689ef480e94bb4daceaa9ca80b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de736689ef480e94bb4daceaa9ca80b">&#9670;&#160;</a></span>EFI_SECURITY_ARCH_PROTOCOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__EFI__SECURITY__ARCH__PROTOCOL.html">_EFI_SECURITY_ARCH_PROTOCOL</a> <a class="el" href="Security_8h.html#a9de736689ef480e94bb4daceaa9ca80b">EFI_SECURITY_ARCH_PROTOCOL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5256c218031c1f0f22820f4333333904" name="a5256c218031c1f0f22820f4333333904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5256c218031c1f0f22820f4333333904">&#9670;&#160;</a></span>EFI_SECURITY_FILE_AUTHENTICATION_STATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * EFI_SECURITY_FILE_AUTHENTICATION_STATE) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="Security_8h.html#a9de736689ef480e94bb4daceaa9ca80b">EFI_SECURITY_ARCH_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> AuthenticationStatus, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="structEFI__DEVICE__PATH__PROTOCOL.html">EFI_DEVICE_PATH_PROTOCOL</a> *File)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The EFI_SECURITY_ARCH_PROTOCOL (SAP) is used to abstract platform-specific policy from the DXE core response to an attempt to use a file that returns a given status for the authentication check from the section extraction protocol.</p>
<p>The possible responses in a given SAP implementation may include locking flash upon failure to authenticate, attestation logging for all signed drivers, and other exception operations. The File parameter allows for possible logging within the SAP of the driver.</p>
<p>If File is NULL, then EFI_INVALID_PARAMETER is returned.</p>
<p>If the file specified by File with an authentication status specified by AuthenticationStatus is safe for the DXE Core to use, then EFI_SUCCESS is returned.</p>
<p>If the file specified by File with an authentication status specified by AuthenticationStatus is not safe for the DXE Core to use under any circumstances, then EFI_ACCESS_DENIED is returned.</p>
<p>If the file specified by File with an authentication status specified by AuthenticationStatus is not safe for the DXE Core to use right now, but it might be possible to use it at a future time, then EFI_SECURITY_VIOLATION is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">This</td><td>The EFI_SECURITY_ARCH_PROTOCOL instance. </td></tr>
    <tr><td class="paramname">AuthenticationStatus</td><td>This is the authentication type returned from the Section Extraction protocol. See the Section Extraction Protocol Specification for details on this type. </td></tr>
    <tr><td class="paramname">File</td><td>This is a pointer to the device path of the file that is being dispatched. This will optionally be used for logging.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The file specified by File did authenticate, and the platform policy dictates that the DXE Core may use File. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>Driver is NULL. </td></tr>
    <tr><td class="paramname">EFI_SECURITY_VIOLATION</td><td>The file specified by File did not authenticate, and the platform policy dictates that File should be placed in the untrusted state. A file may be promoted from the untrusted to the trusted state at a future time with a call to the Trust() DXE Service. </td></tr>
    <tr><td class="paramname">EFI_ACCESS_DENIED</td><td>The file specified by File did not authenticate, and the platform policy dictates that File should not be used for any purpose. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac0d0bc7a4c4da27cd14c97b709f7dc45" name="ac0d0bc7a4c4da27cd14c97b709f7dc45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0d0bc7a4c4da27cd14c97b709f7dc45">&#9670;&#160;</a></span>gEfiSecurityArchProtocolGuid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a> gEfiSecurityArchProtocolGuid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
