<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XenevaOS: XenevaOS/Boot/include/Ppi/Security2.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">XenevaOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6f7cbf0a11b44b0a43b1ec16e930d793.html">XenevaOS</a></li><li class="navelem"><a class="el" href="dir_e155a64606be01e9718a8b1197c63fff.html">Boot</a></li><li class="navelem"><a class="el" href="dir_08690fdcb6b3138c931f33749be09044.html">include</a></li><li class="navelem"><a class="el" href="dir_2e41eab99229ca7640a024195cc9520f.html">Ppi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Security2.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="Ppi_2Security2_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__EFI__PEI__SECURITY2__PPI.html">_EFI_PEI_SECURITY2_PPI</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a53cdbd738e7c97c7e001adb98d26a3a7" id="r_a53cdbd738e7c97c7e001adb98d26a3a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Ppi_2Security2_8h.html#a53cdbd738e7c97c7e001adb98d26a3a7">EFI_PEI_SECURITY2_PPI_GUID</a>&#160;&#160;&#160;  { 0xdcd0be23, 0x9586, 0x40f4, { 0xb6, 0x43, 0x6, 0x52, 0x2c, 0xed, 0x4e, 0xde } }</td></tr>
<tr class="separator:a53cdbd738e7c97c7e001adb98d26a3a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a3a006d2cd413b3e82379fa30b5fea6ed" id="r_a3a006d2cd413b3e82379fa30b5fea6ed"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__EFI__PEI__SECURITY2__PPI.html">_EFI_PEI_SECURITY2_PPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Ppi_2Security2_8h.html#a3a006d2cd413b3e82379fa30b5fea6ed">EFI_PEI_SECURITY2_PPI</a></td></tr>
<tr class="separator:a3a006d2cd413b3e82379fa30b5fea6ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf2fd9b9221432a08f1c44d935696445" id="r_acf2fd9b9221432a08f1c44d935696445"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Ppi_2Security2_8h.html#acf2fd9b9221432a08f1c44d935696445">EFI_PEI_SECURITY_AUTHENTICATION_STATE</a>) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="PiPeiCis_8h.html#a0e7bc722610916e07cd0819a921643dc">EFI_PEI_SERVICES</a> **PeiServices, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="Ppi_2Security2_8h.html#a3a006d2cd413b3e82379fa30b5fea6ed">EFI_PEI_SECURITY2_PPI</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> AuthenticationStatus, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="PiPeiCis_8h.html#aa91cb3539cfb2742ee94c7bd0ab1e702">EFI_PEI_FV_HANDLE</a> FvHandle, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="PiPeiCis_8h.html#a98129642fe8f4e1c925ae7d76995fd56">EFI_PEI_FILE_HANDLE</a> FileHandle, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="actypes_8h.html#a112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> *DeferExecution)</td></tr>
<tr class="separator:acf2fd9b9221432a08f1c44d935696445"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab9da91ab2a7eb38144371fca71199475" id="r_ab9da91ab2a7eb38144371fca71199475"><td class="memItemLeft" align="right" valign="top"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Ppi_2Security2_8h.html#ab9da91ab2a7eb38144371fca71199475">gEfiPeiSecurity2PpiGuid</a></td></tr>
<tr class="separator:ab9da91ab2a7eb38144371fca71199475"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file declares Pei Security2 PPI.</p>
<p>This PPI is installed by some platform PEIM that abstracts the security policy to the PEI Foundation, namely the case of a PEIM's authentication state being returned during the PEI section extraction process.</p>
<p>Copyright (c) 2006 - 2018, Intel Corporation. All rights reserved.<br  />
 This program and the accompanying materials are licensed and made available under the terms and conditions of the BSD License which accompanies this distribution. The full text of the license may be found at <a href="http://opensource.org/licenses/bsd-license.php">http://opensource.org/licenses/bsd-license.php</a></p>
<p>THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.</p>
<dl class="section user"><dt>Revision Reference:</dt><dd>This PPI is introduced in PI Version 1.0. </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a53cdbd738e7c97c7e001adb98d26a3a7" name="a53cdbd738e7c97c7e001adb98d26a3a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53cdbd738e7c97c7e001adb98d26a3a7">&#9670;&#160;</a></span>EFI_PEI_SECURITY2_PPI_GUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EFI_PEI_SECURITY2_PPI_GUID&#160;&#160;&#160;  { 0xdcd0be23, 0x9586, 0x40f4, { 0xb6, 0x43, 0x6, 0x52, 0x2c, 0xed, 0x4e, 0xde } }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a3a006d2cd413b3e82379fa30b5fea6ed" name="a3a006d2cd413b3e82379fa30b5fea6ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a006d2cd413b3e82379fa30b5fea6ed">&#9670;&#160;</a></span>EFI_PEI_SECURITY2_PPI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__EFI__PEI__SECURITY2__PPI.html">_EFI_PEI_SECURITY2_PPI</a> <a class="el" href="Ppi_2Security2_8h.html#a3a006d2cd413b3e82379fa30b5fea6ed">EFI_PEI_SECURITY2_PPI</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acf2fd9b9221432a08f1c44d935696445" name="acf2fd9b9221432a08f1c44d935696445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf2fd9b9221432a08f1c44d935696445">&#9670;&#160;</a></span>EFI_PEI_SECURITY_AUTHENTICATION_STATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * EFI_PEI_SECURITY_AUTHENTICATION_STATE) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="PiPeiCis_8h.html#a0e7bc722610916e07cd0819a921643dc">EFI_PEI_SERVICES</a> **PeiServices, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="Ppi_2Security2_8h.html#a3a006d2cd413b3e82379fa30b5fea6ed">EFI_PEI_SECURITY2_PPI</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> AuthenticationStatus, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="PiPeiCis_8h.html#aa91cb3539cfb2742ee94c7bd0ab1e702">EFI_PEI_FV_HANDLE</a> FvHandle, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="PiPeiCis_8h.html#a98129642fe8f4e1c925ae7d76995fd56">EFI_PEI_FILE_HANDLE</a> FileHandle, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="actypes_8h.html#a112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> *DeferExecution)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allows the platform builder to implement a security policy in response to varying file authentication states.</p>
<p>This service is published by some platform PEIM. The purpose of this service is to expose a given platform's policy-based response to the PEI Foundation. For example, if there is a PEIM in a GUIDed encapsulation section and the extraction of the PEI file section yields an authentication failure, there is no a priori policy in the PEI Foundation. Specifically, this situation leads to the question whether PEIMs that are either not in GUIDed sections or are in sections whose authentication fails should still be executed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PeiServices</td><td>An indirect pointer to the PEI Services Table published by the PEI Foundation. </td></tr>
    <tr><td class="paramname">This</td><td>Interface pointer that implements the particular EFI_PEI_SECURITY2_PPI instance. </td></tr>
    <tr><td class="paramname">AuthenticationStatus</td><td>Authentication status of the file. xx00 Image was not signed. xxx1 Platform security policy override. Assumes same meaning as 0010 (the image was signed, the signature was tested, and the signature passed authentication test). 0010 Image was signed, the signature was tested, and the signature passed authentication test. 0110 Image was signed and the signature was not tested. 1010 Image was signed, the signature was tested, and the signature failed the authentication test. </td></tr>
    <tr><td class="paramname">FvHandle</td><td>Handle of the volume in which the file resides. This allows different policies depending on different firmware volumes. </td></tr>
    <tr><td class="paramname">FileHandle</td><td>Handle of the file under review. </td></tr>
    <tr><td class="paramname">DeferExecution</td><td>Pointer to a variable that alerts the PEI Foundation to defer execution of a PEIM.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The service performed its action successfully. </td></tr>
    <tr><td class="paramname">EFI_SECURITY_VIOLATION</td><td>The object cannot be trusted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab9da91ab2a7eb38144371fca71199475" name="ab9da91ab2a7eb38144371fca71199475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9da91ab2a7eb38144371fca71199475">&#9670;&#160;</a></span>gEfiPeiSecurity2PpiGuid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a> gEfiPeiSecurity2PpiGuid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
