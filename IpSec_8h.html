<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XenevaOS: XenevaOS/Boot/include/Protocol/IpSec.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">XenevaOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6f7cbf0a11b44b0a43b1ec16e930d793.html">XenevaOS</a></li><li class="navelem"><a class="el" href="dir_e155a64606be01e9718a8b1197c63fff.html">Boot</a></li><li class="navelem"><a class="el" href="dir_08690fdcb6b3138c931f33749be09044.html">include</a></li><li class="navelem"><a class="el" href="dir_b641ebb3d870e3bbb06aca4db697d2ea.html">Protocol</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">IpSec.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="IpSecConfig_8h_source.html">Protocol/IpSecConfig.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for IpSec.h:</div>
<div class="dyncontent">
<div class="center"><img src="IpSec_8h__incl.png" border="0" usemap="#aXenevaOS_2Boot_2include_2Protocol_2IpSec_8h" alt=""/></div>
<map name="aXenevaOS_2Boot_2include_2Protocol_2IpSec_8h" id="aXenevaOS_2Boot_2include_2Protocol_2IpSec_8h">
<area shape="rect" title=" " alt="" coords="5,5,180,45"/>
<area shape="rect" href="IpSecConfig_8h.html" title=" " alt="" coords="9,93,176,119"/>
<area shape="poly" title=" " alt="" coords="95,46,95,79,90,79,90,46"/>
</map>
</div>
</div>
<p><a href="IpSec_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__EFI__IPSEC__FRAGMENT__DATA.html">_EFI_IPSEC_FRAGMENT_DATA</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__EFI__IPSEC__PROTOCOL.html">_EFI_IPSEC_PROTOCOL</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__EFI__IPSEC2__PROTOCOL.html">_EFI_IPSEC2_PROTOCOL</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab66442088d23165372dce1da0ccb8fa2" id="r_ab66442088d23165372dce1da0ccb8fa2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#ab66442088d23165372dce1da0ccb8fa2">EFI_IPSEC_PROTOCOL_GUID</a></td></tr>
<tr class="separator:ab66442088d23165372dce1da0ccb8fa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfef7722dd02fda40a3d1ad43d222002" id="r_acfef7722dd02fda40a3d1ad43d222002"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#acfef7722dd02fda40a3d1ad43d222002">EFI_IPSEC2_PROTOCOL_GUID</a></td></tr>
<tr class="separator:acfef7722dd02fda40a3d1ad43d222002"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ab3181f7f07300f70b989d371ed325d36" id="r_ab3181f7f07300f70b989d371ed325d36"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__EFI__IPSEC__PROTOCOL.html">_EFI_IPSEC_PROTOCOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#ab3181f7f07300f70b989d371ed325d36">EFI_IPSEC_PROTOCOL</a></td></tr>
<tr class="separator:ab3181f7f07300f70b989d371ed325d36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace1993b048a59d6d6e0b026c798bef54" id="r_ace1993b048a59d6d6e0b026c798bef54"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__EFI__IPSEC2__PROTOCOL.html">_EFI_IPSEC2_PROTOCOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#ace1993b048a59d6d6e0b026c798bef54">EFI_IPSEC2_PROTOCOL</a></td></tr>
<tr class="separator:ace1993b048a59d6d6e0b026c798bef54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62e365a4f2ad722201fc71a8d32ef026" id="r_a62e365a4f2ad722201fc71a8d32ef026"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__EFI__IPSEC__FRAGMENT__DATA.html">_EFI_IPSEC_FRAGMENT_DATA</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#a62e365a4f2ad722201fc71a8d32ef026">EFI_IPSEC_FRAGMENT_DATA</a></td></tr>
<tr class="separator:a62e365a4f2ad722201fc71a8d32ef026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c4dd423bafb41ffe1a03de84784fab" id="r_a58c4dd423bafb41ffe1a03de84784fab"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#a58c4dd423bafb41ffe1a03de84784fab">EFI_IPSEC_PROCESS</a>) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="IpSec_8h.html#ab3181f7f07300f70b989d371ed325d36">EFI_IPSEC_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="UefiBaseType_8h.html#af943d518ce8a229e7e51ce3fed0e3122">EFI_HANDLE</a> NicHandle, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="actypes_8h.html#ab27e9918b538ce9d8ca692479b375b6a">UINT8</a> IpVer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *IpHead, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="actypes_8h.html#ab27e9918b538ce9d8ca692479b375b6a">UINT8</a> *LastHead, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *OptionsBuffer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> OptionsLength, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="IpSec_8h.html#a62e365a4f2ad722201fc71a8d32ef026">EFI_IPSEC_FRAGMENT_DATA</a> **FragmentTable, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *FragmentCount, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="IpSecConfig_8h.html#a6de0b08c0736a6b70176ca1f0e1c199a">EFI_IPSEC_TRAFFIC_DIR</a> TrafficDirection, <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="UefiBaseType_8h.html#a7f3111de303d836d8d3711c39363f81a">EFI_EVENT</a> *RecycleSignal)</td></tr>
<tr class="separator:a58c4dd423bafb41ffe1a03de84784fab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2873dc74113fbca52f4e75b262c175d0" id="r_a2873dc74113fbca52f4e75b262c175d0"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#a2873dc74113fbca52f4e75b262c175d0">EFI_IPSEC_PROCESSEXT</a>) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="IpSec_8h.html#ace1993b048a59d6d6e0b026c798bef54">EFI_IPSEC2_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="UefiBaseType_8h.html#af943d518ce8a229e7e51ce3fed0e3122">EFI_HANDLE</a> NicHandle, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="actypes_8h.html#ab27e9918b538ce9d8ca692479b375b6a">UINT8</a> IpVer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *IpHead, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="actypes_8h.html#ab27e9918b538ce9d8ca692479b375b6a">UINT8</a> *LastHead, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> **OptionsBuffer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *OptionsLength, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="IpSec_8h.html#a62e365a4f2ad722201fc71a8d32ef026">EFI_IPSEC_FRAGMENT_DATA</a> **FragmentTable, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *FragmentCount, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="IpSecConfig_8h.html#a6de0b08c0736a6b70176ca1f0e1c199a">EFI_IPSEC_TRAFFIC_DIR</a> TrafficDirection, <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="UefiBaseType_8h.html#a7f3111de303d836d8d3711c39363f81a">EFI_EVENT</a> *RecycleSignal)</td></tr>
<tr class="separator:a2873dc74113fbca52f4e75b262c175d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2816e10b624e654383f816348f8c7c4a" id="r_a2816e10b624e654383f816348f8c7c4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#a2816e10b624e654383f816348f8c7c4a">gEfiIpSecProtocolGuid</a></td></tr>
<tr class="separator:a2816e10b624e654383f816348f8c7c4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72721d93e836f1ca9df2639c730f6f5a" id="r_a72721d93e836f1ca9df2639c730f6f5a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="IpSec_8h.html#a72721d93e836f1ca9df2639c730f6f5a">gEfiIpSec2ProtocolGuid</a></td></tr>
<tr class="separator:a72721d93e836f1ca9df2639c730f6f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>EFI IPSEC Protocol Definition The EFI_IPSEC_PROTOCOL is used to abstract the ability to deal with the individual packets sent and received by the host and provide packet-level security for IP datagram. The EFI_IPSEC2_PROTOCOL is used to abstract the ability to deal with the individual packets sent and received by the host and provide packet-level security for IP datagram. In addition, it supports the Option (extension header) processing in IPsec which doesn't support in EFI_IPSEC_PROTOCOL. It is also recommended to use EFI_IPSEC2_PROTOCOL instead of EFI_IPSEC_PROTOCOL especially for IPsec Tunnel Mode.</p>
<p>Copyright (c) 2009 - 2018, Intel Corporation. All rights reserved.<br  />
 This program and the accompanying materials are licensed and made available under the terms and conditions of the BSD License which accompanies this distribution. The full text of the license may be found at <a href="http://opensource.org/licenses/bsd-license.php">http://opensource.org/licenses/bsd-license.php</a></p>
<p>THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.</p>
<dl class="section user"><dt>Revision Reference:</dt><dd>The EFI_IPSEC2_PROTOCOL is introduced in UEFI Specification 2.3D. </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="acfef7722dd02fda40a3d1ad43d222002" name="acfef7722dd02fda40a3d1ad43d222002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfef7722dd02fda40a3d1ad43d222002">&#9670;&#160;</a></span>EFI_IPSEC2_PROTOCOL_GUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EFI_IPSEC2_PROTOCOL_GUID</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  { \</div>
<div class="line">    0xa3979e64, 0xace8, 0x4ddc, {0xbc, 0x7, 0x4d, 0x66, 0xb8, 0xfd, 0x9, 0x77 } \</div>
<div class="line">  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab66442088d23165372dce1da0ccb8fa2" name="ab66442088d23165372dce1da0ccb8fa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab66442088d23165372dce1da0ccb8fa2">&#9670;&#160;</a></span>EFI_IPSEC_PROTOCOL_GUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EFI_IPSEC_PROTOCOL_GUID</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  { \</div>
<div class="line">    0xdfb386f7, 0xe100, 0x43ad, {0x9c, 0x9a, 0xed, 0x90, 0xd0, 0x8a, 0x5e, 0x12 } \</div>
<div class="line">  }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ace1993b048a59d6d6e0b026c798bef54" name="ace1993b048a59d6d6e0b026c798bef54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace1993b048a59d6d6e0b026c798bef54">&#9670;&#160;</a></span>EFI_IPSEC2_PROTOCOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__EFI__IPSEC2__PROTOCOL.html">_EFI_IPSEC2_PROTOCOL</a> <a class="el" href="IpSec_8h.html#ace1993b048a59d6d6e0b026c798bef54">EFI_IPSEC2_PROTOCOL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a62e365a4f2ad722201fc71a8d32ef026" name="a62e365a4f2ad722201fc71a8d32ef026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62e365a4f2ad722201fc71a8d32ef026">&#9670;&#160;</a></span>EFI_IPSEC_FRAGMENT_DATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__EFI__IPSEC__FRAGMENT__DATA.html">_EFI_IPSEC_FRAGMENT_DATA</a> <a class="el" href="IpSec_8h.html#a62e365a4f2ad722201fc71a8d32ef026">EFI_IPSEC_FRAGMENT_DATA</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>EFI_IPSEC_FRAGMENT_DATA defines the instances of packet fragments. </p>

</div>
</div>
<a id="a58c4dd423bafb41ffe1a03de84784fab" name="a58c4dd423bafb41ffe1a03de84784fab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58c4dd423bafb41ffe1a03de84784fab">&#9670;&#160;</a></span>EFI_IPSEC_PROCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * EFI_IPSEC_PROCESS) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="IpSec_8h.html#ab3181f7f07300f70b989d371ed325d36">EFI_IPSEC_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="UefiBaseType_8h.html#af943d518ce8a229e7e51ce3fed0e3122">EFI_HANDLE</a> NicHandle, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="actypes_8h.html#ab27e9918b538ce9d8ca692479b375b6a">UINT8</a> IpVer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *IpHead, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="actypes_8h.html#ab27e9918b538ce9d8ca692479b375b6a">UINT8</a> *LastHead, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *OptionsBuffer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> OptionsLength, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="IpSec_8h.html#a62e365a4f2ad722201fc71a8d32ef026">EFI_IPSEC_FRAGMENT_DATA</a> **FragmentTable, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *FragmentCount, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="IpSecConfig_8h.html#a6de0b08c0736a6b70176ca1f0e1c199a">EFI_IPSEC_TRAFFIC_DIR</a> TrafficDirection, <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="UefiBaseType_8h.html#a7f3111de303d836d8d3711c39363f81a">EFI_EVENT</a> *RecycleSignal)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handles IPsec packet processing for inbound and outbound IP packets.</p>
<p>The EFI_IPSEC_PROCESS process routine handles each inbound or outbound packet. The behavior is that it can perform one of the following actions: bypass the packet, discard the packet, or protect the packet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">This</td><td>Pointer to the EFI_IPSEC_PROTOCOL instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NicHandle</td><td>Instance of the network interface. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IpVer</td><td>IPV4 or IPV6. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">IpHead</td><td>Pointer to the IP Header. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LastHead</td><td>The protocol of the next layer to be processed by IPsec. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OptionsBuffer</td><td>Pointer to the options buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OptionsLength</td><td>Length of the options buffer. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FragmentTable</td><td>Pointer to a list of fragments. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FragmentCount</td><td>Number of fragments. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TrafficDirection</td><td>Traffic direction. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">RecycleSignal</td><td>Event for recycling of resources.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The packet was bypassed and all buffers remain the same. </td></tr>
    <tr><td class="paramname">EFI_SUCCESS</td><td>The packet was protected. </td></tr>
    <tr><td class="paramname">EFI_ACCESS_DENIED</td><td>The packet was discarded. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2873dc74113fbca52f4e75b262c175d0" name="a2873dc74113fbca52f4e75b262c175d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2873dc74113fbca52f4e75b262c175d0">&#9670;&#160;</a></span>EFI_IPSEC_PROCESSEXT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * EFI_IPSEC_PROCESSEXT) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="IpSec_8h.html#ace1993b048a59d6d6e0b026c798bef54">EFI_IPSEC2_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="UefiBaseType_8h.html#af943d518ce8a229e7e51ce3fed0e3122">EFI_HANDLE</a> NicHandle, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="actypes_8h.html#ab27e9918b538ce9d8ca692479b375b6a">UINT8</a> IpVer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *IpHead, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="actypes_8h.html#ab27e9918b538ce9d8ca692479b375b6a">UINT8</a> *LastHead, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> **OptionsBuffer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *OptionsLength, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="IpSec_8h.html#a62e365a4f2ad722201fc71a8d32ef026">EFI_IPSEC_FRAGMENT_DATA</a> **FragmentTable, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *FragmentCount, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="IpSecConfig_8h.html#a6de0b08c0736a6b70176ca1f0e1c199a">EFI_IPSEC_TRAFFIC_DIR</a> TrafficDirection, <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="UefiBaseType_8h.html#a7f3111de303d836d8d3711c39363f81a">EFI_EVENT</a> *RecycleSignal)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handles IPsec processing for both inbound and outbound IP packets. Compare with Process() in EFI_IPSEC_PROTOCOL, this interface has the capability to process Option(Extension Header).</p>
<p>The EFI_IPSEC2_PROCESS process routine handles each inbound or outbound packet. The behavior is that it can perform one of the following actions: bypass the packet, discard the packet, or protect the packet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">This</td><td>Pointer to the EFI_IPSEC2_PROTOCOL instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NicHandle</td><td>Instance of the network interface. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IpVer</td><td>IP version.IPv4 or IPv6. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">IpHead</td><td>Pointer to the IP Header it is either the <a class="el" href="structEFI__IP4__HEADER.html">EFI_IP4_HEADER</a> or EFI_IP6_HEADER. On input, it contains the IP header. On output, 1) in tunnel mode and the traffic direction is inbound, the buffer will be reset to zero by IPsec; 2) in tunnel mode and the traffic direction is outbound, the buffer will reset to be the tunnel IP header.3) in transport mode, the related fielders (like payload length, Next header) in IP header will be modified according to the condition. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">LastHead</td><td>For IP4, it is the next protocol in IP header. For IP6 it is the Next Header of the last extension header. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">OptionsBuffer</td><td>On input, it contains the options (extensions header) to be processed by IPsec. On output, 1) in tunnel mode and the traffic direction is outbound, it will be set to NULL, and that means this contents was wrapped after inner header and should not be concatenated after tunnel header again; 2) in transport mode and the traffic direction is inbound, if there are IP options (extension headers) protected by IPsec, IPsec will concatenate the those options after the input options (extension headers); 3) on other situations, the output of contents of OptionsBuffer might be same with input's. The caller should take the responsibility to free the buffer both on input and on output. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">OptionsLength</td><td>On input, the input length of the options buffer. On output, the output length of the options buffer. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FragmentTable</td><td>Pointer to a list of fragments. On input, these fragments contain the IP payload. On output, 1) in tunnel mode and the traffic direction is inbound, the fragments contain the whole IP payload which is from the IP inner header to the last byte of the packet; 2) in tunnel mode and the traffic direction is the outbound, the fragments contains the whole encapsulated payload which encapsulates the whole IP payload between the encapsulated header and encapsulated trailer fields. 3) in transport mode and the traffic direction is inbound, the fragments contains the IP payload which is from the next layer protocol to the last byte of the packet; 4) in transport mode and the traffic direction is outbound, the fragments contains the whole encapsulated payload which encapsulates the next layer protocol information between the encapsulated header and encapsulated trailer fields. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FragmentCount</td><td>Number of fragments. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TrafficDirection</td><td>Traffic direction. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">RecycleSignal</td><td>Event for recycling of resources.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The packet was processed by IPsec successfully. </td></tr>
    <tr><td class="paramname">EFI_ACCESS_DENIED</td><td>The packet was discarded. </td></tr>
    <tr><td class="paramname">EFI_NOT_READY</td><td>The IKE negotiation is invoked and the packet was discarded. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>One or more of following are TRUE: If OptionsBuffer is NULL; If OptionsLength is NULL; If FragmentTable is NULL; If FragmentCount is NULL. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab3181f7f07300f70b989d371ed325d36" name="ab3181f7f07300f70b989d371ed325d36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3181f7f07300f70b989d371ed325d36">&#9670;&#160;</a></span>EFI_IPSEC_PROTOCOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__EFI__IPSEC__PROTOCOL.html">_EFI_IPSEC_PROTOCOL</a> <a class="el" href="IpSec_8h.html#ab3181f7f07300f70b989d371ed325d36">EFI_IPSEC_PROTOCOL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a72721d93e836f1ca9df2639c730f6f5a" name="a72721d93e836f1ca9df2639c730f6f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72721d93e836f1ca9df2639c730f6f5a">&#9670;&#160;</a></span>gEfiIpSec2ProtocolGuid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a> gEfiIpSec2ProtocolGuid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2816e10b624e654383f816348f8c7c4a" name="a2816e10b624e654383f816348f8c7c4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2816e10b624e654383f816348f8c7c4a">&#9670;&#160;</a></span>gEfiIpSecProtocolGuid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a> gEfiIpSecProtocolGuid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
