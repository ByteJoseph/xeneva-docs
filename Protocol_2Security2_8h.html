<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XenevaOS: XenevaOS/Boot/include/Protocol/Security2.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">XenevaOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6f7cbf0a11b44b0a43b1ec16e930d793.html">XenevaOS</a></li><li class="navelem"><a class="el" href="dir_e155a64606be01e9718a8b1197c63fff.html">Boot</a></li><li class="navelem"><a class="el" href="dir_08690fdcb6b3138c931f33749be09044.html">include</a></li><li class="navelem"><a class="el" href="dir_b641ebb3d870e3bbb06aca4db697d2ea.html">Protocol</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Security2.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="Protocol_2Security2_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__EFI__SECURITY2__ARCH__PROTOCOL.html">_EFI_SECURITY2_ARCH_PROTOCOL</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aac072f5e21cc6105ccd94ac4bae31cbe" id="r_aac072f5e21cc6105ccd94ac4bae31cbe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Protocol_2Security2_8h.html#aac072f5e21cc6105ccd94ac4bae31cbe">EFI_SECURITY2_ARCH_PROTOCOL_GUID</a>&#160;&#160;&#160;  { 0x94ab2f58, 0x1438, 0x4ef1, {0x91, 0x52, 0x18, 0x94, 0x1a, 0x3a, 0x0e, 0x68 } }</td></tr>
<tr class="separator:aac072f5e21cc6105ccd94ac4bae31cbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aa41eefeef7cce592d501615b957b868f" id="r_aa41eefeef7cce592d501615b957b868f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__EFI__SECURITY2__ARCH__PROTOCOL.html">_EFI_SECURITY2_ARCH_PROTOCOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Protocol_2Security2_8h.html#aa41eefeef7cce592d501615b957b868f">EFI_SECURITY2_ARCH_PROTOCOL</a></td></tr>
<tr class="separator:aa41eefeef7cce592d501615b957b868f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf7326841c7b5406b01ff4758cc5d48a" id="r_acf7326841c7b5406b01ff4758cc5d48a"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Protocol_2Security2_8h.html#acf7326841c7b5406b01ff4758cc5d48a">EFI_SECURITY2_FILE_AUTHENTICATION</a>) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="Protocol_2Security2_8h.html#aa41eefeef7cce592d501615b957b868f">EFI_SECURITY2_ARCH_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="structEFI__DEVICE__PATH__PROTOCOL.html">EFI_DEVICE_PATH_PROTOCOL</a> *DevicePath, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *FileBuffer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> FileSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="actypes_8h.html#a112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> BootPolicy)</td></tr>
<tr class="separator:acf7326841c7b5406b01ff4758cc5d48a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a66b0edbfd10d6f49535564910244dadf" id="r_a66b0edbfd10d6f49535564910244dadf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Protocol_2Security2_8h.html#a66b0edbfd10d6f49535564910244dadf">gEfiSecurity2ArchProtocolGuid</a></td></tr>
<tr class="separator:a66b0edbfd10d6f49535564910244dadf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Security2 Architectural Protocol as defined in PI Specification1.2.1 VOLUME 2 DXE</p>
<p>Abstracts security-specific functions from the DXE Foundation of UEFI Image Verification, Trusted Computing Group (TCG) measured boot, and User Identity policy for image loading and consoles. This protocol must be produced by a boot service or runtime DXE driver.</p>
<p>This protocol is optional and must be published prior to the EFI_SECURITY_ARCH_PROTOCOL. As a result, the same driver must publish both of these interfaces.</p>
<p>When both Security and Security2 Architectural Protocols are published, LoadImage must use them in accordance with the following rules: The Security2 protocol must be used on every image being loaded. The Security protocol must be used after the Securiy2 protocol and only on images that have been read using Firmware Volume protocol.</p>
<p>When only Security architectural protocol is published, LoadImage must use it on every image being loaded.</p>
<p>Copyright (c) 2012 - 2018, Intel Corporation. All rights reserved.<br  />
 This program and the accompanying materials are licensed and made available under the terms and conditions of the BSD License which accompanies this distribution. The full text of the license may be found at <a href="http://opensource.org/licenses/bsd-license.php">http://opensource.org/licenses/bsd-license.php</a></p>
<p>THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aac072f5e21cc6105ccd94ac4bae31cbe" name="aac072f5e21cc6105ccd94ac4bae31cbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac072f5e21cc6105ccd94ac4bae31cbe">&#9670;&#160;</a></span>EFI_SECURITY2_ARCH_PROTOCOL_GUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EFI_SECURITY2_ARCH_PROTOCOL_GUID&#160;&#160;&#160;  { 0x94ab2f58, 0x1438, 0x4ef1, {0x91, 0x52, 0x18, 0x94, 0x1a, 0x3a, 0x0e, 0x68 } }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Global ID for the Security2 Code Architectural Protocol </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aa41eefeef7cce592d501615b957b868f" name="aa41eefeef7cce592d501615b957b868f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa41eefeef7cce592d501615b957b868f">&#9670;&#160;</a></span>EFI_SECURITY2_ARCH_PROTOCOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__EFI__SECURITY2__ARCH__PROTOCOL.html">_EFI_SECURITY2_ARCH_PROTOCOL</a> <a class="el" href="Protocol_2Security2_8h.html#aa41eefeef7cce592d501615b957b868f">EFI_SECURITY2_ARCH_PROTOCOL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acf7326841c7b5406b01ff4758cc5d48a" name="acf7326841c7b5406b01ff4758cc5d48a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf7326841c7b5406b01ff4758cc5d48a">&#9670;&#160;</a></span>EFI_SECURITY2_FILE_AUTHENTICATION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * EFI_SECURITY2_FILE_AUTHENTICATION) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="Protocol_2Security2_8h.html#aa41eefeef7cce592d501615b957b868f">EFI_SECURITY2_ARCH_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="structEFI__DEVICE__PATH__PROTOCOL.html">EFI_DEVICE_PATH_PROTOCOL</a> *DevicePath, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *FileBuffer, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> FileSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="actypes_8h.html#a112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> BootPolicy)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The DXE Foundation uses this service to measure and/or verify a UEFI image.</p>
<p>This service abstracts the invocation of Trusted Computing Group (TCG) measured boot, UEFI Secure boot, and UEFI User Identity infrastructure. For the former two, the DXE Foundation invokes the FileAuthentication() with a DevicePath and corresponding image in FileBuffer memory. The TCG measurement code will record the FileBuffer contents into the appropriate PCR. The image verification logic will confirm the integrity and provenance of the image in FileBuffer of length FileSize . The origin of the image will be DevicePath in these cases. If the FileBuffer is NULL, the interface will determine if the DevicePath can be connected in order to support the User Identification policy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">This</td><td>The EFI_SECURITY2_ARCH_PROTOCOL instance. </td></tr>
    <tr><td class="paramname">File</td><td>A pointer to the device path of the file that is being dispatched. This will optionally be used for logging. </td></tr>
    <tr><td class="paramname">FileBuffer</td><td>A pointer to the buffer with the UEFI file image. </td></tr>
    <tr><td class="paramname">FileSize</td><td>The size of the file. </td></tr>
    <tr><td class="paramname">BootPolicy</td><td>A boot policy that was used to call LoadImage() UEFI service. If FileAuthentication() is invoked not from the LoadImage(), BootPolicy must be set to FALSE.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The file specified by DevicePath and non-NULL FileBuffer did authenticate, and the platform policy dictates that the DXE Foundation may use the file. </td></tr>
    <tr><td class="paramname">EFI_SUCCESS</td><td>The device path specified by NULL device path DevicePath and non-NULL FileBuffer did authenticate, and the platform policy dictates that the DXE Foundation may execute the image in FileBuffer. </td></tr>
    <tr><td class="paramname">EFI_SUCCESS</td><td>FileBuffer is NULL and current user has permission to start UEFI device drivers on the device path specified by DevicePath. </td></tr>
    <tr><td class="paramname">EFI_SECURITY_VIOLATION</td><td>The file specified by DevicePath and FileBuffer did not authenticate, and the platform policy dictates that the file should be placed in the untrusted state. The image has been added to the file execution table. </td></tr>
    <tr><td class="paramname">EFI_ACCESS_DENIED</td><td>The file specified by File and FileBuffer did not authenticate, and the platform policy dictates that the DXE Foundation may not use File. </td></tr>
    <tr><td class="paramname">EFI_SECURITY_VIOLATION</td><td>FileBuffer is NULL and the user has no permission to start UEFI device drivers on the device path specified by DevicePath. </td></tr>
    <tr><td class="paramname">EFI_SECURITY_VIOLATION</td><td>FileBuffer is not NULL and the user has no permission to load drivers from the device path specified by DevicePath. The image has been added into the list of the deferred images. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a66b0edbfd10d6f49535564910244dadf" name="a66b0edbfd10d6f49535564910244dadf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66b0edbfd10d6f49535564910244dadf">&#9670;&#160;</a></span>gEfiSecurity2ArchProtocolGuid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a> gEfiSecurity2ArchProtocolGuid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
