<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XenevaOS: XenevaOS/Boot/include/Protocol/Pkcs7Verify.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">XenevaOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6f7cbf0a11b44b0a43b1ec16e930d793.html">XenevaOS</a></li><li class="navelem"><a class="el" href="dir_e155a64606be01e9718a8b1197c63fff.html">Boot</a></li><li class="navelem"><a class="el" href="dir_08690fdcb6b3138c931f33749be09044.html">include</a></li><li class="navelem"><a class="el" href="dir_b641ebb3d870e3bbb06aca4db697d2ea.html">Protocol</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Pkcs7Verify.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="ImageAuthentication_8h_source.html">Guid/ImageAuthentication.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Pkcs7Verify.h:</div>
<div class="dyncontent">
<div class="center"><img src="Pkcs7Verify_8h__incl.png" border="0" usemap="#aXenevaOS_2Boot_2include_2Protocol_2Pkcs7Verify_8h" alt=""/></div>
<map name="aXenevaOS_2Boot_2include_2Protocol_2Pkcs7Verify_8h" id="aXenevaOS_2Boot_2include_2Protocol_2Pkcs7Verify_8h">
<area shape="rect" title=" " alt="" coords="83,5,258,45"/>
<area shape="rect" href="ImageAuthentication_8h.html" title=" " alt="" coords="69,93,273,119"/>
<area shape="poly" title=" " alt="" coords="173,46,173,79,168,79,168,46"/>
<area shape="rect" href="GlobalVariable_8h.html" title=" " alt="" coords="5,167,168,192"/>
<area shape="poly" title=" " alt="" coords="159,121,113,160,109,155,155,117"/>
<area shape="rect" href="Hash_8h.html" title=" " alt="" coords="193,167,317,192"/>
<area shape="poly" title=" " alt="" coords="186,117,232,155,229,160,182,121"/>
</map>
</div>
</div>
<p><a href="Pkcs7Verify_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__EFI__PKCS7__VERIFY__PROTOCOL.html">_EFI_PKCS7_VERIFY_PROTOCOL</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:abea8751b01cdbf710c56ded28248a9c7" id="r_abea8751b01cdbf710c56ded28248a9c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pkcs7Verify_8h.html#abea8751b01cdbf710c56ded28248a9c7">EFI_PKCS7_VERIFY_PROTOCOL_GUID</a></td></tr>
<tr class="separator:abea8751b01cdbf710c56ded28248a9c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a26e4e4e3642cafc31ca39c7645acb8d6" id="r_a26e4e4e3642cafc31ca39c7645acb8d6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__EFI__PKCS7__VERIFY__PROTOCOL.html">_EFI_PKCS7_VERIFY_PROTOCOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pkcs7Verify_8h.html#a26e4e4e3642cafc31ca39c7645acb8d6">EFI_PKCS7_VERIFY_PROTOCOL</a></td></tr>
<tr class="separator:a26e4e4e3642cafc31ca39c7645acb8d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adef6fcacd235afc65523848cd72b9cb2" id="r_adef6fcacd235afc65523848cd72b9cb2"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pkcs7Verify_8h.html#adef6fcacd235afc65523848cd72b9cb2">EFI_PKCS7_VERIFY_BUFFER</a>) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Pkcs7Verify_8h.html#a26e4e4e3642cafc31ca39c7645acb8d6">EFI_PKCS7_VERIFY_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *SignedData, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> SignedDataSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *InData <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> InDataSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **AllowedDb, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **RevokedDb <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **TimeStampDb <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *Content <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> *ContentSize)</td></tr>
<tr class="separator:adef6fcacd235afc65523848cd72b9cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a5b818248f88469d360fd34312b30c8" id="r_a6a5b818248f88469d360fd34312b30c8"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pkcs7Verify_8h.html#a6a5b818248f88469d360fd34312b30c8">EFI_PKCS7_VERIFY_SIGNATURE</a>) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Pkcs7Verify_8h.html#a26e4e4e3642cafc31ca39c7645acb8d6">EFI_PKCS7_VERIFY_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *<a class="el" href="LittleBoot_2pe_8h.html#a3e66eca7759c572008f1619166f39e92">Signature</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> SignatureSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *InHash, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> InHashSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **AllowedDb, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **RevokedDb <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **TimeStampDb <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>)</td></tr>
<tr class="separator:a6a5b818248f88469d360fd34312b30c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac409ec5274ffa08d8d8b44f3d5c2f9e6" id="r_ac409ec5274ffa08d8d8b44f3d5c2f9e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pkcs7Verify_8h.html#ac409ec5274ffa08d8d8b44f3d5c2f9e6">gEfiPkcs7VerifyProtocolGuid</a></td></tr>
<tr class="separator:ac409ec5274ffa08d8d8b44f3d5c2f9e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>EFI_PKCS7_VERIFY_PROTOCOL as defined in UEFI 2.5. The EFI_PKCS7_VERIFY_PROTOCOL is used to verify data signed using PKCS#7 formatted authentication. The PKCS#7 data to be verified must be binary DER encoded. PKCS#7 is a general-purpose cryptographic standard (defined by RFC2315, available at <a href="http://tools.ietf.org/html/rfc2315">http://tools.ietf.org/html/rfc2315</a>).</p>
<p>Copyright (c) 2015 - 2017, Intel Corporation. All rights reserved.<br  />
 This program and the accompanying materials are licensed and made available under the terms and conditions of the BSD License that accompanies this distribution. The full text of the license may be found at <a href="http://opensource.org/licenses/bsd-license.php">http://opensource.org/licenses/bsd-license.php</a>.</p>
<p>THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="abea8751b01cdbf710c56ded28248a9c7" name="abea8751b01cdbf710c56ded28248a9c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea8751b01cdbf710c56ded28248a9c7">&#9670;&#160;</a></span>EFI_PKCS7_VERIFY_PROTOCOL_GUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EFI_PKCS7_VERIFY_PROTOCOL_GUID</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  { \</div>
<div class="line">    0x47889fb2, 0xd671, 0x4fab, {0xa0, 0xca, 0xdf, 0x0e, 0x44, 0xdf, 0x70, 0xd6 } \</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Global ID for the PKCS7 Verification Protocol </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="adef6fcacd235afc65523848cd72b9cb2" name="adef6fcacd235afc65523848cd72b9cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adef6fcacd235afc65523848cd72b9cb2">&#9670;&#160;</a></span>EFI_PKCS7_VERIFY_BUFFER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * EFI_PKCS7_VERIFY_BUFFER) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Pkcs7Verify_8h.html#a26e4e4e3642cafc31ca39c7645acb8d6">EFI_PKCS7_VERIFY_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *SignedData, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> SignedDataSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *InData <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> InDataSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **AllowedDb, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **RevokedDb <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **TimeStampDb <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *Content <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> *ContentSize)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Processes a buffer containing binary DER-encoded PKCS7 signature. The signed data content may be embedded within the buffer or separated. Funtion verifies the signature of the content is valid and signing certificate was not revoked and is contained within a list of trusted signers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">This</td><td>Pointer to EFI_PKCS7_VERIFY_PROTOCOL instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SignedData</td><td>Points to buffer containing ASN.1 DER-encoded PKCS7 signature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SignedDataSize</td><td>The size of SignedData buffer in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">InData</td><td>In case of detached signature, InData points to buffer containing the raw message data previously signed and to be verified by function. In case of SignedData containing embedded data, InData must be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">InDataSize</td><td>When InData is used, the size of InData buffer in bytes. When InData is NULL. This parameter must be 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AllowedDb</td><td>Pointer to a list of pointers to <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> structures. The list is terminated by a null pointer. The <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> structures contain lists of X.509 certificates of approved signers. Function recognizes signer certificates of type EFI_CERT_X509_GUID. Any hash certificate in AllowedDb list is ignored by this function. Function returns success if signer of the buffer is within this list (and not within RevokedDb). This parameter is required. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RevokedDb</td><td>Optional pointer to a list of pointers to <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> structures. The list is terminated by a null pointer. List of X.509 certificates of revoked signers and revoked file hashes. Except as noted in description of TimeStampDb signature verification will always fail if the signer of the file or the hash of the data component of the buffer is in RevokedDb list. This list is optional and caller may pass Null or pointer to NULL if not required. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TimeStampDb</td><td>Optional pointer to a list of pointers to <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> structures. The list is terminated by a null pointer. This parameter can be used to pass a list of X.509 certificates of trusted time stamp signers. This list is optional and caller must pass Null or pointer to NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Content</td><td>On input, points to an optional caller-allocated buffer into which the function will copy the content portion of the file after verification succeeds. This parameter is optional and if NULL, no copy of content from file is performed. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ContentSize</td><td>On input, points to the size in bytes of the optional buffer Content previously allocated by caller. On output, if the verification succeeds, the value referenced by ContentSize will contain the actual size of the content from signed file. If ContentSize indicates the caller-allocated buffer is too small to contain content, an error is returned, and ContentSize will be updated with the required size. This parameter must be 0 if Content is Null.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>Content signature was verified against hash of content, the signer's certificate was not found in RevokedDb, and was found in AllowedDb or if in signer is found in both AllowedDb and RevokedDb, the signing was allowed by reference to TimeStampDb as described above, and no hash matching content hash was found in RevokedDb. </td></tr>
    <tr><td class="paramname">EFI_SECURITY_VIOLATION</td><td>The SignedData buffer was correctly formatted but signer was in RevokedDb or not in AllowedDb. Also returned if matching content hash found in RevokedDb. </td></tr>
    <tr><td class="paramname">EFI_COMPROMISED_DATA</td><td>Calculated hash differs from signed hash. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>SignedData is NULL or SignedDataSize is zero. AllowedDb is NULL. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>Content is not NULL and ContentSize is NULL. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Unsupported or invalid format in TimeStampDb, RevokedDb or AllowedDb list contents was detected. </td></tr>
    <tr><td class="paramname">EFI_NOT_FOUND</td><td>Content not found because InData is NULL and no content embedded in SignedData. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>The SignedData buffer was not correctly formatted for processing by the function. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>Signed data embedded in SignedData but InData is not NULL. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>The size of buffer indicated by ContentSize is too small to hold the content. ContentSize updated to required size. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a26e4e4e3642cafc31ca39c7645acb8d6" name="a26e4e4e3642cafc31ca39c7645acb8d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26e4e4e3642cafc31ca39c7645acb8d6">&#9670;&#160;</a></span>EFI_PKCS7_VERIFY_PROTOCOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__EFI__PKCS7__VERIFY__PROTOCOL.html">_EFI_PKCS7_VERIFY_PROTOCOL</a> <a class="el" href="Pkcs7Verify_8h.html#a26e4e4e3642cafc31ca39c7645acb8d6">EFI_PKCS7_VERIFY_PROTOCOL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a5b818248f88469d360fd34312b30c8" name="a6a5b818248f88469d360fd34312b30c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a5b818248f88469d360fd34312b30c8">&#9670;&#160;</a></span>EFI_PKCS7_VERIFY_SIGNATURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="UefiBaseType_8h.html#a5f446f35c9f907a4f1cf22e794ba338d">EFI_STATUS</a>(<a class="el" href="AArch64_2ProcessorBind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * EFI_PKCS7_VERIFY_SIGNATURE) (<a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="Pkcs7Verify_8h.html#a26e4e4e3642cafc31ca39c7645acb8d6">EFI_PKCS7_VERIFY_PROTOCOL</a> *This, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *<a class="el" href="LittleBoot_2pe_8h.html#a3e66eca7759c572008f1619166f39e92">Signature</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> SignatureSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="acefi_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> *InHash, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="AArch64_2ProcessorBind_8h.html#a4a2fc3b6f740e9cca9f895579c167560">UINTN</a> InHashSize, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **AllowedDb, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **RevokedDb <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>, <a class="el" href="Base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> **TimeStampDb <a class="el" href="Base_8h.html#afdff552467cc2d2d5815831e9656cffc">OPTIONAL</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Processes a buffer containing binary DER-encoded detached PKCS7 signature. The hash of the signed data content is calculated and passed by the caller. Function verifies the signature of the content is valid and signing certificate was not revoked and is contained within a list of trusted signers.</p>
<p>Note: because this function uses hashes and the specification contains a variety of hash choices, you should be aware that the check against the RevokedDb list will improperly succeed if the signature is revoked using a different hash algorithm. For this reason, you should either cycle through all UEFI supported hashes to see if one is forbidden, or rely on a single hash choice only if the UEFI signature authority only signs and revokes with a single hash (at time of writing, this hash choice is SHA256).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">This</td><td>Pointer to EFI_PKCS7_VERIFY_PROTOCOL instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Signature</td><td>Points to buffer containing ASN.1 DER-encoded PKCS detached signature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SignatureSize</td><td>The size of Signature buffer in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">InHash</td><td>InHash points to buffer containing the caller calculated hash of the data. The parameter may not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">InHashSize</td><td>The size in bytes of InHash buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AllowedDb</td><td>Pointer to a list of pointers to <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> structures. The list is terminated by a null pointer. The <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> structures contain lists of X.509 certificates of approved signers. Function recognizes signer certificates of type EFI_CERT_X509_GUID. Any hash certificate in AllowedDb list is ignored by this function. Function returns success if signer of the buffer is within this list (and not within RevokedDb). This parameter is required. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RevokedDb</td><td>Optional pointer to a list of pointers to <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> structures. The list is terminated by a null pointer. List of X.509 certificates of revoked signers and revoked file hashes. Signature verification will always fail if the signer of the file or the hash of the data component of the buffer is in RevokedDb list. This parameter is optional and caller may pass Null if not required. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TimeStampDb</td><td>Optional pointer to a list of pointers to <a class="el" href="structEFI__SIGNATURE__LIST.html">EFI_SIGNATURE_LIST</a> structures. The list is terminated by a null pointer. This parameter can be used to pass a list of X.509 certificates of trusted time stamp counter-signers.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>Signed hash was verified against caller-provided hash of content, the signer's certificate was not found in RevokedDb, and was found in AllowedDb or if in signer is found in both AllowedDb and RevokedDb, the signing was allowed by reference to TimeStampDb as described above, and no hash matching content hash was found in RevokedDb. </td></tr>
    <tr><td class="paramname">EFI_SECURITY_VIOLATION</td><td>The SignedData buffer was correctly formatted but signer was in RevokedDb or not in AllowedDb. Also returned if matching content hash found in RevokedDb. </td></tr>
    <tr><td class="paramname">EFI_COMPROMISED_DATA</td><td>Caller provided hash differs from signed hash. Or, caller and encrypted hash are different sizes. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>Signature is NULL or SignatureSize is zero. InHash is NULL or InHashSize is zero. AllowedDb is NULL. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Unsupported or invalid format in TimeStampDb, RevokedDb or AllowedDb list contents was detected. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>The Signature buffer was not correctly formatted for processing by the function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac409ec5274ffa08d8d8b44f3d5c2f9e6" name="ac409ec5274ffa08d8d8b44f3d5c2f9e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac409ec5274ffa08d8d8b44f3d5c2f9e6">&#9670;&#160;</a></span>gEfiPkcs7VerifyProtocolGuid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="UefiBaseType_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a> gEfiPkcs7VerifyProtocolGuid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
